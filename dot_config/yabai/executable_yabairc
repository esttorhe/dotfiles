# load the scripting-addition
sudo yabai --load-sa

# default layout (can be bsp, stack or float)
yabai -m config layout bsp

# New window spawns to the right if vertical split, or bottom if horizontal split
yabai -m config window_placement second_child

# global settings
yabai -m config                                
yabai -m config mouse_follows_focus          on            
yabai -m config window_origin_display        default       
yabai -m config window_placement             second_child  
yabai -m config window_shadow                on           
yabai -m config window_animation_duration    0.10          
yabai -m config window_opacity_duration      0.2           
yabai -m config active_window_opacity        1.0           
yabai -m config normal_window_opacity        0.75          
yabai -m config window_opacity               on            
yabai -m config split_ratio                  0.50          
yabai -m config split_type                   auto          
yabai -m config auto_balance                 on           
yabai -m config top_padding                  5            
yabai -m config bottom_padding               5            
yabai -m config left_padding                 5            
yabai -m config right_padding                5            
yabai -m config window_gap                   6            
yabai -m config layout                       bsp           
yabai -m config mouse_modifier               ctrl          
yabai -m config mouse_action1                move          
yabai -m config mouse_action2                resize        
yabai -m config mouse_drop_action            swap
yabai -m config menubar_opacity              1.0

# App-specific rules for window management
yabai -m rule --add app="^System Settings$" manage=off
yabai -m rule --add app="^Todoist$" manage=off layer=above
yabai -m rule --add app="^WezTerm$" manage=on sticky=on layer=above opacity=1.0

# Critical: 1Password authentication and security windows must be unmanaged
yabai -m rule --add app="^1Password.*$" manage=off layer=above
yabai -m rule --add title="^1Password.*$" manage=off layer=above
yabai -m rule --add app="^TouchID.*$" manage=off layer=above
yabai -m rule --add title=".*1Password.*" manage=off layer=above
yabai -m rule --add title="Touch ID" manage=off layer=above
yabai -m rule --add title=".*authentication.*" manage=off layer=above

# Automatic app placement rules
# Development workspace (Space 1)
yabai -m rule --add app="^Neovide$" space=1

# Communications
yabai -m rule --add app="^Discord$" space=2
yabai -m rule --add app="^Telegram$" space=3
yabai -m rule --add app="^WhatsApp$" space=4
yabai -m rule --add app="^Slack$" space=10

# Productivity workspace
yabai -m rule --add app="^Notion$" space=5
yabai -m rule --add app="^Notion Calendar$" space=6
yabai -m rule --add app="^Asana$" space=7
yabai -m rule --add app="^Zen$" space=8

# Music/Media workspace
yabai -m rule --add app="^Spotify$" space=9

# Display-specific configuration signals
yabai -m signal --add event=display_added action="~/.config/yabai/scripts/yabai-display-setup.sh added"
yabai -m signal --add event=display_removed action="~/.config/yabai/scripts/yabai-display-setup.sh removed"

yabai -m config debug_output on
