# ABOUTME: Fish shell configuration - minimal entry point
# ABOUTME: Environment, PATH, abbreviations loaded from conf.d/; functions from functions/

# Only run in interactive mode
status is-interactive; or exit

# Disable greeting
set fish_greeting ""

# ============================================
# Tool integrations
# ============================================

# Starship prompt
starship init fish | source

# Atuin shell history
if type -q atuin
    atuin init fish | source
end

# Mise version manager
if type -q mise
    mise activate fish | source
end

# fzf keybindings
if type -q fzf
    fzf --fish | source
end

# direnv
if type -q direnv
    direnv hook fish | source
end

# zoxide
if type -q zoxide
    zoxide init fish | source
end

# ============================================
# Completions
# ============================================

# OpenClaw completion
if type -q openclaw
    openclaw completion --shell fish | source
end

# Bun completions
if test -f "$BUN_INSTALL/_bun"
    source "$BUN_INSTALL/_bun"
end

# ============================================
# Shell startup
# ============================================

# Fortune/habits reminder on shell start
if type -q fortune; and test -d "$HOME/.local/habits"
    fortune "$HOME/.local/habits"
    echo
end

# ============================================
# Keybindings
# ============================================

# Vi mode
set -g fish_key_bindings fish_vi_key_bindings

# Ctrl+L: Clear screen and show fortune
bind \cl clear_with_fortune
